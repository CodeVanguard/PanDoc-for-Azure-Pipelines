# This file is part of PanDoc for Azure Pipelines,
# Copyright (C) 2020-2025 Code Vanguard LLC

trigger: none

pool:
  vmImage: 'windows-latest'

steps:
- task: DownloadPanDoc@2

- task: RunPanDoc@2
  inputs:
    sourceFiles: '$(System.DefaultWorkingDirectory)/README.md'
    inputFormat: 'gfm'
    outputFormat: 'html5'
    destFile: '$(Build.ArtifactStagingDirectory)/README.html'
    additionalArgs: '--resource-path=$(System.DefaultWorkingDirectory)'
    workingDirectory: $(Pipeline.Workspace)

- task: RunPanDoc@2
  inputs:
    sourceFiles: '$(System.DefaultWorkingDirectory)/README.md'
    inputFormat: 'gfm'
    outputFormat: 'docx'
    destFile: '$(Build.ArtifactStagingDirectory)/README.docx'
    additionalArgs: '--resource-path=$(System.DefaultWorkingDirectory)'
    workingDirectory: $(Pipeline.Workspace)

- task: PublishBuildArtifacts@1
  inputs:
    PathtoPublish: '$(Build.ArtifactStagingDirectory)'
    ArtifactName: 'drop'
    publishLocation: 'Container'
